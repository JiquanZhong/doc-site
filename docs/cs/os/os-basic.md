---
sidebar_position: 1
---

# 操作系统基础

## 什么是操作系统？

- 操作系统本质上是一个运行在电脑上的软件，用于管理硬件和软件资源的程序。
- 操作系统屏蔽了硬件层面的复杂性，向上提供了更方便的接口。
- 操作系统的内核（Kernel）是操作系统的核心，负责内存系统、硬件系统、文件系统和应用程序的管理。内核是连接硬件和应用的桥梁。

![Kernel Layout](assets/d.png)

:::tip 注意

Kernel并不是CPU，Kernel属于软件系统层面，而CPU属于硬件层面。

:::

## 操作系统主要有哪些功能？

操作系统主要包括以下功能：

- 进程和线程管理
- 存储管理
- 文件管理
- 设备管理
- 网络管理
- 安全管理

## 常见的操作系统有哪些？

- Windows
- Unix
- Linux（参考于Unix）
- Mac OS（基于Unix）

## 用户态和内核态

根据进程访问资源的状态特点，可以把它分为两个级别：

- 用户态：用户态运行的进程可以访问应用的所有数据，但拥有比较低的权限，无法执行读写磁盘、网络通信等特权指令，如需执行特权指令，则需要像操作系统发起系统调用从而转为内核态。
- 内核态：内核台运行的进程可以访问操作系统的所有资源，拥有极高的权限。执行完相关的系统调用后，就会把结果返回给用户态进程，再切换回用户态。

内核态拥有更高的权限，能执行更底层，更敏感的操作。但是上下文切换会带来额外的开销（进程需保存当前的执行状态，然后CPU加载另一个线程进入执行），所以应该尽量避免进入内核态的次数。

## 用户态到内核态的切换方式

- 系统调用：由用户态进程**主动**发起，为了使用内核态进程完成一些特权操作，比如读取磁盘。
- 中断：但外围设备完成任务后，会像CPU发送一个中断指令，这时CPU会暂停执行下一条指令，转而去执行中断信号对应的处理程序。如果先前执行的程序是在用户态，那么这个转换就完成了一次从用户态到内核态。
- 异常：但CPU在执行用户态的程序发生了不可预知的异常时（比如缺页异常），就会异常所对应的处理机制，从而转换到内核态。

## 什么是系统调用

在用户态的进程中，凡事涉及到与操作系统级别的资源相关的操作，都需要发起系统调用，委托内核态的进程完成。这些系统调用可分为以下几类：

- 设备管理
- 文件管理
- 进程管理
- 内存管理

整个流程可分为以下步骤：

1. 用户态进程执行到操作系统资源的相关操作时，发起系统调用
2. CPU由用户态切换到内核态，相关进程执行系统调用
3. 调用结束后，结果返回给用户态